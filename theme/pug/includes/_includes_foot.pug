script(src=`${site.url.path}/assets/pjax-api.min.js`)
script.
  var Pjax = require('pjax-api').Pjax;
  new Pjax({  areas: ['#main, #sidebar, #breadcrumb', '#grid', 'body'], update: { head: 'meta, link' }  });

script.
  var current_baseurl = "/#{locale}/";

  var locales = {
    ja: "/ja/"
  };
  if (window.location.search.indexOf('moved') == -1){
    var url = locales[window.navigator.language.slice(0, 2)];
    if (url){
      if(url != current_baseurl) Pjax.replace(url + "?moved", {});
    }
    else {Pjax.replace("/ja/?moved", {});}
  } else {
    history.replaceState(null, null, window.location.href.replace(/\?.*$/,""));
  }

if(site.disqus)
  script
    | (function() {var d = document, s = d.createElement('script');s.src = 'https://#{site.disqus}.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s);})();
